# TIL Template

## 날짜: 2025-03-06

### 스크럼
- 오늘 할 일
클라우드 실습 - code deploy
- 특이사항 : AWS 비용 메일 
- 작일 할 일 : 클라우드 실습
- 작일 회고 : 로드 밸런서 연결이 되지 않았다.



### 새로 배운 내용
#### 주제 1: RDB

## AWS에서 제공하는 완전 관리형 데이터베이스

- 클라우드 환경에서 관계형 데이터베이스를 직접 설치할 필요 없이 몇 가지 설정만으로 데이터베이스가 실행되는 서버를 생성할 수 있는 서비스
- **DB가 설치된 RDS 전용 가상 서버를 특정 서브넷에 생성**

## RDB 이용 시 고가용성 확보 방법

### Multi-AZ

- RDS 인스턴스를 추가로 생성하여 원래 RDS 인스턴스에 문제 발생 시 대체해서 사용
- 서로 다른 가용영역에 RDS 인스턴스를 배치하여 특정 가용영역에 문제 발생 시에도 서비스 정상 운영 가능

#### 주제 2: ELB
### 로드 밸런싱

- 네트워크 트래픽을 하나 이상의 서버나 장비로 분산하기 위해 사용되는 기술
- SW나 HW를 통해 로드 밸런싱을 수행할 수 있다.
- 서비스 사용자의 요청을 서버로 분산해서 전달

### 웹 트래픽 증가에 따른 대응 방법

1. Scale up
    - CPU/RAM/Disk 성능/network 대역폭 증가
    - 비싸고 성능 좋은 서버로 변경
2. Scale Out
    - 부하를 처리할 서버 대수를 늘림
    - 저렴한 서버 여러 대를 이용해 더 많은 부하를 감당

## 로드 밸런싱 방식

### Round Robin

- 로드 밸런서에서 서버 선택 시 , 다음 순차적으로 서버를 선택하는 방법
    
    ✅ **장점**
    
    - 설정이 간단하며 **모든 서버에 균등하게 트래픽을 분산**.
    - 특정 서버에 부하가 집중되지 않아 트래픽이 일정하게 분배됨.
    - 서버가 비슷한 성능을 가진 경우 **효율적인 로드 밸런싱 가능**.
    
    ❌ **단점**
    
    - **서버의 부하 상태를 고려하지 않음** → 어떤 서버가 더 많은 요청을 처리할 수 있는지 알 수 없음.
    - 특정 서버가 처리 속도가 느리면 **일부 요청이 지연**될 수 있음.
    
    📌 **적합한 환경**: 동일한 성능의 서버가 여러 대 있는 환경 (e.g., 정적 콘텐츠 제공)
    

### Hash (==Sticky Session)

- 로드 밸런서에서 서버 선택 시 , 클라이언트가 서버와 한 번 연결 되면, 그 이후에는 항상 같은 서버로 연결하는 방식
    
    ✅ **장점**
    
    - 특정 클라이언트가 **항상 같은 서버와 연결** → 로그인 정보 유지 가능.
    - **세션 데이터 유지가 필요한 애플리케이션**(예: 전자상거래, 결제 시스템)에 유용.
    
    ❌ **단점**
    
    - 특정 서버에 요청이 몰릴 가능성이 높음 → 부하 분산이 불균형할 수 있음.
    - 서버 장애 시, 해당 클라이언트가 새로운 서버와 연결되면서 **세션 데이터 손실 가능성**.
    
    📌 **적합한 환경**: **로그인 세션 유지가 필요한 서비스** (e.g., 전자상거래, 채팅 서버)
    

### Least Connection

- 로드 밸런서에서 서버 선택 시 , 연결 수 가 가장 적은 서버를 선택
    
    ✅ **장점**
    
    - 현재 **부하가 가장 적은 서버를 선택**하므로 효율적.
    - 동시 접속 수가 높은 애플리케이션에서 **서버 리소스를 최적화**할 수 있음.
    
    ❌ **단점**
    
    - 장기 연결(예: WebSocket, 스트리밍)이 많으면 **특정 서버에 부하 집중** 가능.
    - 연결 수만 고려하므로 **서버의 처리 성능까지 고려하지 못할 수도 있음**.
    
    📌 **적합한 환경**: **높은 동시 접속을 처리하는 서비스** (e.g., 스트리밍, WebSocket 서버)
    

### 응답시간(**Response Time**)

- 로드 밸런서에서 서버 선택 시 , 응답 속도가 가장 빠른 서버를 선택
    
    ✅ **장점**
    
    - 실시간으로 **응답 속도가 빠른 서버를 선택**하여 성능 최적화.
    - 느린 서버를 자동으로 회피하여 **사용자 경험을 향상**.
    
    ❌ **단점**
    
    - **응답 시간이 순간적으로 변동**하면 부하 분산이 불안정할 수 있음.
    - 고성능 서버가 계속 선택될 가능성이 있어 **일부 서버가 과부하될 위험**.
    
    📌 **적합한 환경**: **실시간 응답이 중요한 서비스** (e.g., 검색 엔진, API 서버)
    

## ELB 유형

### ALB

- OSI 7 Layer 중 application Layer에 속하는 패킷을 처리
- HTTP/HTTPS 프로토콜

✅ **적용 사례**

- **웹 애플리케이션**: HTTP/HTTPS 트래픽을 처리해야 하는 서비스
- **마이크로서비스**: URL 경로 기반 라우팅이 필요한 환경 (예: `/api` → 서비스 A, `/user` → 서비스 B)
- **REST API**: JSON 데이터를 주고받는 API 서버
- **WebSocket 지원**: 실시간 채팅, 알림 시스템 등

✅ **예제**

- `https://example.com/login` → `EC2 서버 1`
- `https://example.com/api` → `EC2 서버 2`
- `https://example.com/chat` → `WebSocket 서버`

### NLB

- OSI 7Layer 중 Transport Layer에 속하는 패킷을 처리
- TCP 프로토콜
- 트래픽 처리에 강함

✅ **적용 사례**

- **고성능 트래픽 처리**: 수백만 개의 요청을 초당 처리해야 하는 환경 (예: 게임 서버, 금융 거래 시스템)
- **실시간 스트리밍 서비스**: IoT, VoIP(음성 통화), 실시간 메시징
- **TCP/UDP 트래픽 처리**: HTTP가 아닌 프로토콜(TCP, UDP 등) 기반 서비스
- **고정 IP 필요**: 정적 IP가 필요한 네트워크 애플리케이션

✅ **예제**

- `TCP: 443` → **VPN 서버**
- `UDP: 1935` → **라이브 스트리밍 서버**
- `TCP: 5222` → **메신저 서비스**

### CLB

- OSI 7Layer 중 Network 및 TransportLayer에 속하느 패킷을 처리
- 과거에 사용되던 방식으로 호환성을 위해 유지되는 상태

✅ **적용 사례**

- **기존 레거시 애플리케이션**: 오래된 AWS 환경에서 사용되던 시스템
- **ALB/NLB 이전을 고려 중인 시스템**
- **단순한 HTTP, TCP 트래픽 분산이 필요한 경우**

✅ **예제**

- 기존 `http://old-application.com` 서비스 유지

## ELB 옵션

- 인터넷 트래픽용 VS 내부 네트워크 트래픽용
    1. 인터넷 프래픽용 
        - 인터넷을 통해 ELB에 접근하는 경우

## ELB 동작 특징

### 상태 확인 서비스

- ELB에서 연결할 서버들의 상태를 상시 체크
- 비정상 상태의 서버로 트래픽을 전달하지 않음
- ELB에서 서버 측에 요청을 전달해서 응답을 받음으로써 처리되며, 서버의 보안그룹에서 해당 요청을 받을 수 있도록 지정된 포트에 대해 접근을 허용해야 함

### 고가용성 지원

- ELB를 서로 다른 가용 영역에 해당하는 서브넷 생성
- 특정 가용 영역에 문제가 발생하더라도 다른 가용 영역의 ELB가 트래픽을 처리

### 자동확장 동작 방식

- 트래픽이 적을 때는 적은 수의 서버를 유지
- 트래픽이 많을 때는 서버를 실행 시켜 안정성 확보
- 비용 최적화 가능

## 자동 확장 그룹

- 확장, 축소에 사용될 EC2인스턴스의 논리적 집합
- 자동확장에 의해 늘어나거나 줄어든 대상들의 집합을 의미

### 인스턴스 개수 조정 옵션

- 항상 지정된 수의 인스턴스 유지
- 수동 조정
    - 사용자가 직접 그룹의 인스턴스 개수를 조정
- 일정 기반 조정
    - 특정 시간대에 인스턴스를 확장하고, 그 시간대가 지나면 다시 인스턴스를 축소
- 온디맨드 기반 조정
    - EC2 지표(Metic)을 기바능로 조정
    - 예시 ) CPU 사용률이 80%이상일 때 , EC2 인스턴스를 늘림


#### 주제 3: Lamda

### AWS Lamda

- Serverless
- 등록된 일정이나 지정된 이벤트에 의해 코드가 실행
- 비교적 새로운 개념이지만, 방법을 익히고 나면 쉽게 사용할 수 있음
- 서버를 프로비저닝하거나 관리하지 않고도 애플리케이션과 서비스를 구축 및 실행 가능

![image.png](attachment:512a3dcf-9c85-407b-b6f2-f93d1411a7ce:image.png)

- 다양한 프로그래밍 언어 지원
- 완전히 자동화된 관리
    - 코드를 등록 수 실행 과정에 대한 관리가 전혀 필요 없음
- 내결함성 기본 제공
    - Lamda 서비스에 등록된 함수는 리전 내의 여러 가용 영역 내에서 실핼ㅇ되어 특정 가용영역에 문제가 생기더라도 정상적인 서비스 운영이 가능
- 여러 함수의 오케스트레이션 지원
- 사용량에 따라 요금 지불
- 

## 🔍 **AWS Lambda의 주요 특징**

### **서버리스(Serverless) 컴퓨팅**

- 인프라 관리 없이 **코드만 업로드하면 실행 가능**
- AWS에서 자동으로 **컴퓨팅 리소스를 할당하고 관리**
- **EC2 인스턴스 없이 이벤트 기반 실행 가능**

### **이벤트 기반 실행**

- Lambda는 **다양한 AWS 서비스와 연동 가능**
- 특정 이벤트 발생 시 자동으로 실행됨
    - 예: **S3 파일 업로드 → Lambda 실행**
    - 예: **API Gateway 요청 → Lambda 실행**
    - 예: **DynamoDB 변경 → Lambda 실행**

### **다양한 프로그래밍 언어 지원**

- 지원 언어: **Python, Node.js, Java, Go, .NET, Ruby**
- **컨테이너 이미지 기반 배포 지원** (Docker 활용 가능)

### **비용 효율성**

- 사용한 만큼만 요금이 부과됨 (**초당 1ms 단위 과금**)
- **유휴 상태 비용 없음** → 비용 절감 효과

## **Lambda의 실행 구조**

Lambda는 **핵심적으로 이벤트 기반**으로 동작하며, 다음과 같은 흐름을 가짐:

- **이벤트 트리거 발생** → (예: S3 파일 업로드)
- **Lambda 함수 실행** → (이벤트를 처리하는 코드 실행)
- **결과 반환** → (예: 이미지 리사이징 후 S3 저장)

## **Lambda 활용 사례**

### **API 백엔드 서버 구축**

- **API Gateway + Lambda** 조합으로 REST API 서버 구현 가능
- 서버를 직접 운영하지 않고 **자동 확장 가능**

✅ **사용 예제**

- 사용자가 `https://api.example.com/user`로 요청
- API Gateway가 요청을 받아 Lambda 실행
- Lambda가 **DynamoDB에서 사용자 정보 조회 후 응답 반환**

---

### **S3 파일 업로드 자동 처리**

- **S3 버킷에 파일이 업로드되면 자동 실행**
- 이미지 리사이징, 데이터 변환 등의 작업 가능

✅ **사용 예제**

- 사용자가 S3에 **이미지 업로드**
- Lambda가 자동 실행되어 이미지 리사이징
- 변환된 이미지를 다시 S3에 저장

---

### **실시간 데이터 처리**

- **DynamoDB, Kinesis와 연계하여 실시간 스트리밍 데이터 처리 가능**
- 로그 분석, 데이터 변환, 실시간 알림 등에 활용

✅ **사용 예제**

- DynamoDB 테이블 데이터가 변경되면 Lambda 실행
- 새로운 데이터를 분석 후 CloudWatch에 로그 저장

## **Lambda 한계점 및 고려 사항**

### **실행 시간 제한 (최대 15분)**

- 긴 시간 실행이 필요한 경우 **EC2, Fargate, Step Functions 고려**

### **VPC 내부 리소스 접근 제한**

- 기본적으로 VPC 외부에서 실행됨
- **VPC 내부 리소스(DB, Private Subnet) 접근하려면 설정 필요**

### **상태 유지 불가능**

- Lambda는 **스테이트리스(Stateless)** 환경이므로, 세션 저장 불가
- 세션 데이터는 **DynamoDB, S3, ElastiCache 등에 저장 필요**

### 오늘의 도전 과제와 해결 방법
- 도전 과제 1: AWS codedeploy, self hosting 실습
- 도전 과제 2: 코테공부

### 오늘의 회고
- 실습하는데 집중이 어려웠던 것 같다. 아직 막히는 부분이 많아 조금 어려웠다.

### 참고 자료 및 링크
- [링크 제목](URL)
- [링크 제목](URL)
